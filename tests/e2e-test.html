<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClubCalendar E2E Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-header {
            max-width: 1200px;
            margin: 0 auto 20px;
            padding: 15px 20px;
            background: #2c5aa0;
            color: white;
            border-radius: 8px;
        }
        .test-header h1 {
            margin: 0 0 5px 0;
            font-size: 24px;
        }
        .test-header p {
            margin: 0;
            opacity: 0.9;
            font-size: 14px;
        }
        #clubcalendar {
            max-width: 1200px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="test-header">
        <h1>ClubCalendar E2E Test</h1>
        <p>Test page for E2E tests with mock data</p>
    </div>

    <div id="clubcalendar"></div>

<script>
// Test configuration
window.CLUBCALENDAR_CONFIG = {
    waAccountId: 'TEST',
    headerTitle: 'Test Events',
    showMyEvents: true,
    showFilters: true,
    defaultView: 'dayGridMonth',
    primaryColor: '#2c5aa0',
    accentColor: '#d4a800',
    audience: 'member',
    memberLevel: 'member'
};

// Mock data for E2E tests
window.DEMO_MODE = true;
window.DEMO_EVENTS = generateMockEvents();
window.DEMO_USER = { Id: 12345, Email: 'member@example.com', FirstName: 'Test', LastName: 'User' };
window.DEMO_REGISTRATIONS = [
    { EventId: 1001, Status: 'Confirmed' },
    { EventId: 1005, Status: 'Waitlisted' }
];

function generateMockEvents() {
    const events = [];
    const today = new Date();

    // Create diverse set of events for testing search
    const testEvents = [
        { name: 'Wine Tasting Evening', committee: 'Wine Appreciation', location: 'Local Winery', description: 'Sample fine wines from local vineyards', tags: 'wine,social' },
        { name: 'Happy Hikers: Mountain Trail', committee: 'Happy Hikers', location: 'State Park', description: 'Enjoy beautiful mountain views on moderate hike', tags: 'outdoors,hiking' },
        { name: 'Games Night', committee: 'Games!', location: 'Community Center', description: 'Board games and cards for all skill levels', tags: 'games,social' },
        { name: 'Cooking Class: Italian', committee: 'Epicurious', location: 'Kitchen Studio', description: 'Learn to make pasta with wine pairing', tags: 'food,cooking' },
        { name: 'TGIF Happy Hour', committee: 'TGIF', location: 'Beach Bar', description: 'Weekly social gathering', tags: 'social,drinks', price: 0 },
        { name: 'Garden Tour', committee: 'Garden', location: 'Member Home', description: 'Tour beautiful local gardens', tags: 'gardening,outdoors' },
        { name: 'Golf Tournament', committee: 'Golf', location: 'Golf Course', description: 'Friendly competition', tags: 'sports,golf', price: 45 },
        { name: 'Theater Night', committee: 'Performing Arts', location: 'Local Theater', description: 'Watch a live performance', tags: 'arts,entertainment', price: 35 },
        { name: 'Yoga Workshop', committee: 'Wellness', location: 'Fitness Center', description: 'Beginner-friendly yoga session', tags: 'wellness,fitness', price: 0 },
        { name: 'Cycling Adventure', committee: 'Cycling', location: 'Bike Trail', description: 'Scenic 15-mile ride', tags: 'sports,outdoors' },
        { name: 'Book Club Discussion', committee: '', location: 'Library', description: 'Discuss this months novel', tags: 'books,discussion', price: 0 },
        { name: 'Ski Trip: Mammoth', committee: 'Snow Sports', location: 'Mammoth Mountain', description: '3-day ski adventure', tags: 'sports,travel', isMultiDay: true },
    ];

    for (let i = 0; i < testEvents.length; i++) {
        const e = testEvents[i];
        const daysOffset = (i * 5) - 5; // Spread events over time
        const eventDate = new Date(today);
        eventDate.setDate(eventDate.getDate() + daysOffset);

        // Vary the day of week for weekend filter testing
        if (i % 3 === 0) {
            // Make this a weekend event
            const day = eventDate.getDay();
            if (day !== 0 && day !== 6) {
                eventDate.setDate(eventDate.getDate() + (6 - day));
            }
        }

        const hour = 10 + (i % 10); // Vary start times
        eventDate.setHours(hour, 0, 0, 0);

        const endDate = new Date(eventDate);
        if (e.isMultiDay) {
            endDate.setDate(endDate.getDate() + 3);
        } else {
            endDate.setHours(endDate.getHours() + 2);
        }

        events.push({
            Id: 1000 + i,
            Name: e.name,
            StartDate: eventDate.toISOString(),
            EndDate: endDate.toISOString(),
            Location: e.location,
            Details: `<p>${e.description}</p>`,
            AccessLevel: i % 4 === 0 ? 'Public' : 'MembersOnly',
            RegistrationEnabled: true,
            RegistrationsLimit: 20 + (i * 5),
            ConfirmedRegistrationsCount: Math.floor(Math.random() * 20),
            HasWaitlist: i % 3 === 0,
            EventFee: e.price !== undefined ? e.price : (i % 2 === 0 ? 0 : 15 + (i * 2)),
            Tags: e.tags ? e.tags.split(',').map(t => ({ TagName: t.trim() })) : [],
            Url: `https://sbnewcomers.org/event-${1000 + i}`
        });
    }

    return events;
}
</script>

<!-- Load the widget from file -->
<script src="/widget/clubcalendar-widget.js"></script>

</body>
</html>
